=== Training started for VisionTransformer with strategy: partial ===
Device: cuda, LR: 0.0001, Batch size: 50, Epochs: 20
[Strategy 2] Training last 30.0% of layers (46/154): 26,184,962 / 85,996,034 (30.45%)
[VisionTransformer] Train Epoch 1: Loss=0.24496, Acc=0.90095
[VisionTransformer] Val Epoch 1: Loss=0.08218, Acc=0.97111
[VisionTransformer] Warning: very low grad mean (9.28e-05)
[VisionTransformer] Train Epoch 2: Loss=0.06643, Acc=0.97714
[VisionTransformer] Val Epoch 2: Loss=0.06296, Acc=0.97333
[VisionTransformer] Warning: very low grad mean (7.31e-05)
[VisionTransformer] Warning: very low grad mean (8.29e-05)
[VisionTransformer] Warning: very low grad mean (6.05e-05)
[VisionTransformer] Warning: very low grad mean (7.19e-05)
[VisionTransformer] Warning: very low grad mean (3.34e-05)
[VisionTransformer] Warning: very low grad mean (4.53e-05)
[VisionTransformer] Warning: very low grad mean (9.20e-05)
[VisionTransformer] Warning: very low grad mean (7.95e-05)
[VisionTransformer] Warning: very low grad mean (9.19e-05)
[VisionTransformer] Train Epoch 3: Loss=0.01405, Acc=0.99667
[VisionTransformer] Val Epoch 3: Loss=0.13461, Acc=0.95778
[VisionTransformer] Warning: very low grad mean (7.78e-05)
[VisionTransformer] Warning: very low grad mean (2.92e-05)
[VisionTransformer] Warning: very low grad mean (4.79e-05)
[VisionTransformer] Warning: very low grad mean (6.82e-05)
[VisionTransformer] Warning: very low grad mean (5.04e-05)
[VisionTransformer] Warning: very low grad mean (8.48e-05)
[VisionTransformer] Warning: very low grad mean (2.57e-05)
[VisionTransformer] Warning: very low grad mean (6.27e-05)
[VisionTransformer] Warning: very low grad mean (6.13e-05)
[VisionTransformer] Warning: very low grad mean (2.58e-05)
[VisionTransformer] Warning: very low grad mean (5.32e-05)
[VisionTransformer] Warning: very low grad mean (4.94e-05)
[VisionTransformer] Warning: very low grad mean (2.41e-05)
[VisionTransformer] Warning: very low grad mean (3.41e-05)
[VisionTransformer] Warning: very low grad mean (2.84e-05)
[VisionTransformer] Warning: very low grad mean (4.24e-05)
[VisionTransformer] Warning: very low grad mean (5.08e-05)
[VisionTransformer] Warning: very low grad mean (1.74e-05)
[VisionTransformer] Warning: very low grad mean (4.39e-05)
[VisionTransformer] Warning: very low grad mean (2.07e-05)
[VisionTransformer] Warning: very low grad mean (7.89e-05)
[VisionTransformer] Warning: very low grad mean (2.53e-05)
[VisionTransformer] Warning: very low grad mean (1.89e-05)
[VisionTransformer] Warning: very low grad mean (2.74e-05)
[VisionTransformer] Warning: very low grad mean (2.36e-05)
[VisionTransformer] Warning: very low grad mean (2.24e-05)
[VisionTransformer] Warning: very low grad mean (2.20e-05)
[VisionTransformer] Warning: very low grad mean (8.03e-05)
[VisionTransformer] Warning: very low grad mean (1.27e-05)
[VisionTransformer] Warning: very low grad mean (2.16e-05)
[VisionTransformer] Warning: very low grad mean (1.84e-05)
[VisionTransformer] Warning: very low grad mean (2.23e-05)
[VisionTransformer] Warning: very low grad mean (1.78e-05)
[VisionTransformer] Train Epoch 4: Loss=0.00276, Acc=1.00000
[VisionTransformer] Val Epoch 4: Loss=0.10060, Acc=0.96889
[VisionTransformer] Warning: very low grad mean (1.81e-05)
[VisionTransformer] Warning: very low grad mean (3.02e-05)
[VisionTransformer] Warning: very low grad mean (2.85e-05)
[VisionTransformer] Warning: very low grad mean (1.80e-05)
[VisionTransformer] Warning: very low grad mean (1.68e-05)
[VisionTransformer] Warning: very low grad mean (2.17e-05)
[VisionTransformer] Warning: very low grad mean (1.28e-05)
[VisionTransformer] Warning: very low grad mean (7.78e-05)
[VisionTransformer] Warning: very low grad mean (1.48e-05)
[VisionTransformer] Warning: very low grad mean (3.72e-05)
[VisionTransformer] Warning: very low grad mean (2.14e-05)
[VisionTransformer] Warning: very low grad mean (3.97e-05)
[VisionTransformer] Warning: very low grad mean (5.37e-05)
[VisionTransformer] Warning: very low grad mean (1.71e-05)
[VisionTransformer] Warning: very low grad mean (1.29e-05)
[VisionTransformer] Warning: very low grad mean (5.06e-05)
[VisionTransformer] Warning: very low grad mean (3.29e-05)
[VisionTransformer] Warning: very low grad mean (1.77e-05)
[VisionTransformer] Warning: very low grad mean (1.32e-05)
[VisionTransformer] Warning: very low grad mean (1.29e-05)
[VisionTransformer] Warning: very low grad mean (8.53e-06)
[VisionTransformer] Warning: very low grad mean (6.35e-05)
[VisionTransformer] Warning: very low grad mean (1.23e-05)
[VisionTransformer] Warning: very low grad mean (1.92e-05)
[VisionTransformer] Warning: very low grad mean (1.38e-05)
[VisionTransformer] Warning: very low grad mean (2.99e-05)
[VisionTransformer] Warning: very low grad mean (8.32e-05)
[VisionTransformer] Warning: very low grad mean (1.92e-05)
[VisionTransformer] Warning: very low grad mean (3.08e-05)
[VisionTransformer] Warning: very low grad mean (2.30e-05)
[VisionTransformer] Warning: very low grad mean (1.11e-05)
[VisionTransformer] Warning: very low grad mean (2.65e-05)
[VisionTransformer] Warning: very low grad mean (9.14e-05)
[VisionTransformer] Train Epoch 5: Loss=0.00550, Acc=0.99857
[VisionTransformer] Val Epoch 5: Loss=0.14378, Acc=0.97333
[VisionTransformer] Warning: very low grad mean (2.41e-05)
[VisionTransformer] Warning: very low grad mean (1.24e-05)
[VisionTransformer] Warning: very low grad mean (1.17e-05)
[VisionTransformer] Warning: very low grad mean (1.21e-05)
[VisionTransformer] Warning: very low grad mean (1.62e-05)
[VisionTransformer] Warning: very low grad mean (9.27e-05)
[VisionTransformer] Warning: very low grad mean (9.07e-05)
[VisionTransformer] Warning: very low grad mean (1.60e-05)
[VisionTransformer] Warning: very low grad mean (2.44e-05)
[VisionTransformer] Warning: very low grad mean (3.10e-05)
[VisionTransformer] Warning: very low grad mean (1.45e-05)
[VisionTransformer] Warning: very low grad mean (1.58e-05)
[VisionTransformer] Warning: very low grad mean (7.42e-05)
[VisionTransformer] Warning: very low grad mean (1.85e-05)
[VisionTransformer] Warning: very low grad mean (4.82e-05)
[VisionTransformer] Warning: very low grad mean (2.02e-05)
[VisionTransformer] Warning: very low grad mean (1.89e-05)
[VisionTransformer] Warning: very low grad mean (9.86e-05)
[VisionTransformer] Warning: very low grad mean (2.52e-05)
[VisionTransformer] Warning: very low grad mean (2.05e-05)
[VisionTransformer] Warning: very low grad mean (5.62e-05)
[VisionTransformer] Warning: very low grad mean (1.60e-05)
[VisionTransformer] Warning: very low grad mean (1.44e-05)
[VisionTransformer] Warning: very low grad mean (1.78e-05)
[VisionTransformer] Warning: very low grad mean (3.87e-05)
[VisionTransformer] Warning: very low grad mean (7.13e-05)
[VisionTransformer] Warning: very low grad mean (1.04e-05)
[VisionTransformer] Warning: very low grad mean (9.71e-06)
[VisionTransformer] Warning: very low grad mean (4.20e-05)
[VisionTransformer] Warning: very low grad mean (1.73e-05)
[VisionTransformer] Warning: very low grad mean (1.52e-05)
[VisionTransformer] Warning: very low grad mean (1.45e-05)
[VisionTransformer] Warning: very low grad mean (1.66e-05)
[VisionTransformer] Train Epoch 6: Loss=0.00508, Acc=0.99857
[VisionTransformer] Val Epoch 6: Loss=0.12623, Acc=0.96889
[VisionTransformer] Warning: very low grad mean (1.15e-05)
[VisionTransformer] Warning: very low grad mean (1.24e-05)
[VisionTransformer] Warning: very low grad mean (1.22e-05)
[VisionTransformer] Warning: very low grad mean (9.69e-06)
[VisionTransformer] Warning: very low grad mean (4.64e-05)
[VisionTransformer] Warning: very low grad mean (4.86e-05)
[VisionTransformer] Warning: very low grad mean (2.83e-05)
[VisionTransformer] Warning: very low grad mean (2.48e-05)
[VisionTransformer] Warning: very low grad mean (9.33e-06)
[VisionTransformer] Warning: very low grad mean (6.20e-05)
[VisionTransformer] Warning: very low grad mean (2.12e-05)
[VisionTransformer] Warning: very low grad mean (1.34e-05)
[VisionTransformer] Warning: very low grad mean (6.89e-05)
[VisionTransformer] Warning: very low grad mean (1.58e-05)
[VisionTransformer] Warning: very low grad mean (2.46e-05)
[VisionTransformer] Warning: very low grad mean (7.47e-05)
[VisionTransformer] Warning: very low grad mean (1.26e-05)
[VisionTransformer] Warning: very low grad mean (2.14e-05)
[VisionTransformer] Warning: very low grad mean (1.92e-05)
[VisionTransformer] Warning: very low grad mean (1.88e-05)
[VisionTransformer] Warning: very low grad mean (1.40e-05)
[VisionTransformer] Warning: very low grad mean (1.33e-05)
[VisionTransformer] Warning: very low grad mean (5.41e-05)
[VisionTransformer] Warning: very low grad mean (8.21e-06)
[VisionTransformer] Warning: very low grad mean (4.69e-05)
[VisionTransformer] Warning: very low grad mean (1.20e-05)
[VisionTransformer] Warning: very low grad mean (1.10e-05)
[VisionTransformer] Warning: very low grad mean (8.17e-05)
[VisionTransformer] Warning: very low grad mean (1.03e-05)
[VisionTransformer] Warning: very low grad mean (1.78e-05)
[VisionTransformer] Warning: very low grad mean (1.08e-05)
[VisionTransformer] Warning: very low grad mean (5.08e-05)
[VisionTransformer] Warning: very low grad mean (5.02e-05)
[VisionTransformer] Train Epoch 7: Loss=0.00197, Acc=1.00000
[VisionTransformer] Val Epoch 7: Loss=0.13384, Acc=0.96667
[VisionTransformer] Warning: very low grad mean (1.20e-05)
[VisionTransformer] Warning: very low grad mean (8.67e-06)
[VisionTransformer] Warning: very low grad mean (1.48e-05)
[VisionTransformer] Warning: very low grad mean (7.77e-06)
[VisionTransformer] Warning: very low grad mean (1.32e-05)
[VisionTransformer] Warning: very low grad mean (7.79e-06)
[VisionTransformer] Warning: very low grad mean (1.14e-05)
[VisionTransformer] Warning: very low grad mean (2.07e-05)
[VisionTransformer] Warning: very low grad mean (1.06e-05)
[VisionTransformer] Warning: very low grad mean (1.66e-05)
[VisionTransformer] Warning: very low grad mean (7.87e-05)
[VisionTransformer] Warning: very low grad mean (1.08e-05)
[VisionTransformer] Warning: very low grad mean (2.11e-05)
[VisionTransformer] Warning: very low grad mean (1.91e-05)
[VisionTransformer] Warning: very low grad mean (1.68e-05)
[VisionTransformer] Warning: very low grad mean (2.45e-05)
[VisionTransformer] Warning: very low grad mean (6.56e-06)
[VisionTransformer] Warning: very low grad mean (2.20e-05)
[VisionTransformer] Warning: very low grad mean (1.94e-05)
[VisionTransformer] Warning: very low grad mean (8.62e-06)
[VisionTransformer] Warning: very low grad mean (5.84e-06)
[VisionTransformer] Warning: very low grad mean (9.75e-06)
[VisionTransformer] Warning: very low grad mean (1.35e-05)
[VisionTransformer] Warning: very low grad mean (5.07e-05)
[VisionTransformer] Warning: very low grad mean (3.10e-05)
[VisionTransformer] Warning: very low grad mean (1.18e-05)
[VisionTransformer] Warning: very low grad mean (9.11e-06)
[VisionTransformer] Warning: very low grad mean (5.87e-06)
[VisionTransformer] Warning: very low grad mean (4.58e-05)
[VisionTransformer] Warning: very low grad mean (8.38e-06)
[VisionTransformer] Warning: very low grad mean (7.82e-06)
[VisionTransformer] Warning: very low grad mean (6.39e-06)
[VisionTransformer] Warning: very low grad mean (1.34e-05)
[VisionTransformer] Warning: very low grad mean (8.47e-06)
[VisionTransformer] Warning: very low grad mean (1.26e-05)
[VisionTransformer] Warning: very low grad mean (1.92e-05)
[VisionTransformer] Train Epoch 8: Loss=0.00135, Acc=1.00000
[VisionTransformer] Val Epoch 8: Loss=0.10522, Acc=0.97333
[VisionTransformer] Warning: very low grad mean (4.70e-05)
[VisionTransformer] Warning: very low grad mean (5.27e-06)
[VisionTransformer] Warning: very low grad mean (4.00e-05)
[VisionTransformer] Warning: very low grad mean (8.91e-06)
[VisionTransformer] Warning: very low grad mean (1.07e-05)
[VisionTransformer] Warning: very low grad mean (7.71e-06)
[VisionTransformer] Warning: very low grad mean (7.78e-06)
[VisionTransformer] Warning: very low grad mean (5.75e-06)
[VisionTransformer] Warning: very low grad mean (6.56e-06)
[VisionTransformer] Warning: very low grad mean (5.41e-06)
[VisionTransformer] Warning: very low grad mean (5.16e-06)
[VisionTransformer] Warning: very low grad mean (6.73e-05)
[VisionTransformer] Warning: very low grad mean (1.05e-05)
[VisionTransformer] Warning: very low grad mean (1.23e-05)
[VisionTransformer] Warning: very low grad mean (4.88e-05)
[VisionTransformer] Warning: very low grad mean (4.46e-06)
[VisionTransformer] Warning: very low grad mean (2.04e-05)
[VisionTransformer] Warning: very low grad mean (9.76e-06)
[VisionTransformer] Warning: very low grad mean (8.95e-06)
[VisionTransformer] Warning: very low grad mean (4.89e-05)
[VisionTransformer] Warning: very low grad mean (7.30e-05)
[VisionTransformer] Warning: very low grad mean (5.11e-05)
[VisionTransformer] Warning: very low grad mean (2.49e-05)
[VisionTransformer] Warning: very low grad mean (4.21e-05)
[VisionTransformer] Train Epoch 9: Loss=0.01747, Acc=0.99524
[VisionTransformer] Val Epoch 9: Loss=0.09750, Acc=0.96222
[VisionTransformer] Warning: very low grad mean (3.59e-05)
[VisionTransformer] Warning: very low grad mean (5.31e-05)
[VisionTransformer] Warning: very low grad mean (4.58e-05)
[VisionTransformer] Warning: very low grad mean (5.40e-05)
[VisionTransformer] Warning: very low grad mean (8.12e-05)
[VisionTransformer] Warning: very low grad mean (4.68e-05)
[VisionTransformer] Warning: very low grad mean (6.36e-05)
[VisionTransformer] Warning: very low grad mean (4.44e-05)
[VisionTransformer] Warning: very low grad mean (2.31e-05)
[VisionTransformer] Warning: very low grad mean (4.31e-05)
[VisionTransformer] Warning: very low grad mean (3.34e-05)
[VisionTransformer] Warning: very low grad mean (9.27e-05)
[VisionTransformer] Warning: very low grad mean (7.69e-05)
[VisionTransformer] Warning: very low grad mean (2.11e-05)
[VisionTransformer] Warning: very low grad mean (1.54e-05)
[VisionTransformer] Warning: very low grad mean (1.40e-05)
[VisionTransformer] Warning: very low grad mean (2.69e-05)
[VisionTransformer] Warning: very low grad mean (5.45e-05)
[VisionTransformer] Warning: very low grad mean (8.45e-05)
[VisionTransformer] Warning: very low grad mean (4.75e-05)
[VisionTransformer] Warning: very low grad mean (4.09e-05)
[VisionTransformer] Warning: very low grad mean (3.71e-05)
[VisionTransformer] Warning: very low grad mean (5.77e-05)
[VisionTransformer] Warning: very low grad mean (3.64e-05)
[VisionTransformer] Train Epoch 10: Loss=0.00825, Acc=0.99762
[VisionTransformer] Val Epoch 10: Loss=0.11949, Acc=0.97333
[VisionTransformer] Warning: very low grad mean (1.75e-05)
[VisionTransformer] Warning: very low grad mean (1.13e-05)
[VisionTransformer] Warning: very low grad mean (1.47e-05)
[VisionTransformer] Warning: very low grad mean (1.10e-05)
[VisionTransformer] Warning: very low grad mean (9.55e-06)
[VisionTransformer] Warning: very low grad mean (7.95e-06)
[VisionTransformer] Warning: very low grad mean (8.54e-06)
[VisionTransformer] Warning: very low grad mean (9.60e-06)
[VisionTransformer] Warning: very low grad mean (8.98e-06)
[VisionTransformer] Warning: very low grad mean (7.66e-06)
[VisionTransformer] Warning: very low grad mean (7.11e-06)
[VisionTransformer] Warning: very low grad mean (7.53e-06)
[VisionTransformer] Warning: very low grad mean (1.04e-05)
[VisionTransformer] Warning: very low grad mean (7.22e-06)
[VisionTransformer] Warning: very low grad mean (8.48e-06)
[VisionTransformer] Warning: very low grad mean (2.56e-05)
[VisionTransformer] Warning: very low grad mean (4.96e-06)
[VisionTransformer] Warning: very low grad mean (6.32e-06)
[VisionTransformer] Warning: very low grad mean (1.83e-05)
[VisionTransformer] Warning: very low grad mean (6.15e-06)
[VisionTransformer] Warning: very low grad mean (5.96e-06)
[VisionTransformer] Warning: very low grad mean (5.37e-06)
[VisionTransformer] Warning: very low grad mean (2.51e-05)
[VisionTransformer] Warning: very low grad mean (3.91e-06)
[VisionTransformer] Warning: very low grad mean (7.82e-06)
[VisionTransformer] Warning: very low grad mean (9.76e-06)
[VisionTransformer] Warning: very low grad mean (6.28e-06)
[VisionTransformer] Warning: very low grad mean (7.93e-06)
[VisionTransformer] Warning: very low grad mean (6.40e-06)
[VisionTransformer] Warning: very low grad mean (1.96e-05)
[VisionTransformer] Warning: very low grad mean (2.60e-05)
[VisionTransformer] Warning: very low grad mean (1.48e-05)
[VisionTransformer] Warning: very low grad mean (5.58e-05)
[VisionTransformer] Warning: very low grad mean (7.40e-06)
[VisionTransformer] Warning: very low grad mean (8.03e-06)
[VisionTransformer] Warning: very low grad mean (5.06e-06)
[VisionTransformer] Warning: very low grad mean (1.00e-05)
[VisionTransformer] Warning: very low grad mean (4.66e-06)
[VisionTransformer] Warning: very low grad mean (1.30e-05)
[VisionTransformer] Train Epoch 11: Loss=0.00074, Acc=1.00000
[VisionTransformer] Val Epoch 11: Loss=0.09892, Acc=0.97556
[VisionTransformer] Warning: very low grad mean (6.78e-06)
[VisionTransformer] Warning: very low grad mean (4.76e-06)
[VisionTransformer] Warning: very low grad mean (1.26e-05)
[VisionTransformer] Warning: very low grad mean (4.81e-06)
[VisionTransformer] Warning: very low grad mean (5.56e-06)
[VisionTransformer] Warning: very low grad mean (6.58e-06)
[VisionTransformer] Warning: very low grad mean (1.65e-05)
[VisionTransformer] Warning: very low grad mean (4.71e-06)
[VisionTransformer] Warning: very low grad mean (6.60e-06)
[VisionTransformer] Warning: very low grad mean (6.59e-06)
[VisionTransformer] Warning: very low grad mean (6.08e-06)
[VisionTransformer] Warning: very low grad mean (6.00e-06)
[VisionTransformer] Warning: very low grad mean (3.54e-06)
[VisionTransformer] Warning: very low grad mean (9.96e-06)
[VisionTransformer] Warning: very low grad mean (6.43e-06)
[VisionTransformer] Warning: very low grad mean (1.30e-05)
[VisionTransformer] Warning: very low grad mean (4.68e-06)
[VisionTransformer] Warning: very low grad mean (9.55e-06)
[VisionTransformer] Warning: very low grad mean (5.58e-06)
[VisionTransformer] Warning: very low grad mean (1.31e-05)
[VisionTransformer] Warning: very low grad mean (7.79e-06)
[VisionTransformer] Warning: very low grad mean (5.87e-06)
[VisionTransformer] Warning: very low grad mean (5.28e-06)
[VisionTransformer] Warning: very low grad mean (8.23e-06)
[VisionTransformer] Warning: very low grad mean (4.11e-06)
[VisionTransformer] Warning: very low grad mean (3.85e-06)
[VisionTransformer] Warning: very low grad mean (5.20e-06)
[VisionTransformer] Warning: very low grad mean (8.75e-06)
[VisionTransformer] Warning: very low grad mean (4.09e-06)
[VisionTransformer] Warning: very low grad mean (5.62e-06)
[VisionTransformer] Warning: very low grad mean (4.71e-06)
[VisionTransformer] Warning: very low grad mean (5.46e-06)
[VisionTransformer] Warning: very low grad mean (4.63e-06)
[VisionTransformer] Warning: very low grad mean (4.43e-06)
[VisionTransformer] Warning: very low grad mean (5.16e-06)
[VisionTransformer] Warning: very low grad mean (3.24e-06)
[VisionTransformer] Warning: very low grad mean (2.89e-06)
[VisionTransformer] Warning: very low grad mean (5.49e-06)
[VisionTransformer] Warning: very low grad mean (3.97e-06)
[VisionTransformer] Warning: very low grad mean (3.81e-06)
[VisionTransformer] Warning: very low grad mean (3.11e-06)
[VisionTransformer] Warning: very low grad mean (3.18e-06)
[VisionTransformer] Train Epoch 12: Loss=0.00026, Acc=1.00000
[VisionTransformer] Val Epoch 12: Loss=0.11359, Acc=0.97778
[VisionTransformer] Early stopping on epoch 12
Accuracy on Test: 0.98000
=== Training finished for VisionTransformer ===

