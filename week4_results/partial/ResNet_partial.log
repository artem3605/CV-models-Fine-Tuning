=== Training started for ResNet with strategy: partial ===
Device: cuda, LR: 0.0001, Batch size: 50, Epochs: 20
[Strategy 2] Training last 30.0% of layers (140/469): 28,633,602 / 58,668,866 (48.81%)
[ResNet] Train Epoch 1: Loss=0.37091, Acc=0.87048
[ResNet] Val Epoch 1: Loss=0.14784, Acc=0.93556
[ResNet] Train Epoch 2: Loss=0.08557, Acc=0.97524
[ResNet] Val Epoch 2: Loss=0.10959, Acc=0.95333
[ResNet] Warning: very low grad mean (8.35e-05)
[ResNet] Warning: very low grad mean (9.23e-05)
[ResNet] Warning: very low grad mean (9.33e-05)
[ResNet] Warning: very low grad mean (4.29e-05)
[ResNet] Warning: very low grad mean (7.61e-05)
[ResNet] Warning: very low grad mean (8.16e-05)
[ResNet] Warning: very low grad mean (3.45e-05)
[ResNet] Train Epoch 3: Loss=0.04615, Acc=0.98476
[ResNet] Val Epoch 3: Loss=0.12801, Acc=0.94444
[ResNet] Warning: very low grad mean (4.70e-05)
[ResNet] Warning: very low grad mean (5.09e-05)
[ResNet] Warning: very low grad mean (9.98e-05)
[ResNet] Warning: very low grad mean (7.77e-05)
[ResNet] Warning: very low grad mean (7.78e-05)
[ResNet] Warning: very low grad mean (6.16e-05)
[ResNet] Warning: very low grad mean (8.21e-05)
[ResNet] Warning: very low grad mean (8.58e-05)
[ResNet] Warning: very low grad mean (6.44e-05)
[ResNet] Warning: very low grad mean (8.61e-05)
[ResNet] Warning: very low grad mean (6.79e-05)
[ResNet] Warning: very low grad mean (4.00e-05)
[ResNet] Warning: very low grad mean (7.82e-05)
[ResNet] Warning: very low grad mean (3.01e-05)
[ResNet] Warning: very low grad mean (8.43e-05)
[ResNet] Warning: very low grad mean (3.78e-05)
[ResNet] Warning: very low grad mean (5.19e-05)
[ResNet] Warning: very low grad mean (6.86e-05)
[ResNet] Warning: very low grad mean (6.26e-05)
[ResNet] Warning: very low grad mean (9.80e-05)
[ResNet] Warning: very low grad mean (1.88e-05)
[ResNet] Train Epoch 4: Loss=0.02188, Acc=0.99476
[ResNet] Val Epoch 4: Loss=0.12438, Acc=0.95333
[ResNet] Warning: very low grad mean (8.97e-06)
[ResNet] Warning: very low grad mean (2.58e-05)
[ResNet] Warning: very low grad mean (2.66e-05)
[ResNet] Warning: very low grad mean (1.69e-05)
[ResNet] Warning: very low grad mean (2.74e-05)
[ResNet] Warning: very low grad mean (2.55e-05)
[ResNet] Warning: very low grad mean (3.21e-05)
[ResNet] Warning: very low grad mean (3.97e-05)
[ResNet] Warning: very low grad mean (2.55e-05)
[ResNet] Warning: very low grad mean (9.40e-05)
[ResNet] Warning: very low grad mean (2.54e-05)
[ResNet] Warning: very low grad mean (1.09e-05)
[ResNet] Warning: very low grad mean (6.10e-05)
[ResNet] Warning: very low grad mean (5.74e-05)
[ResNet] Warning: very low grad mean (8.95e-05)
[ResNet] Warning: very low grad mean (1.81e-05)
[ResNet] Warning: very low grad mean (2.51e-05)
[ResNet] Warning: very low grad mean (7.15e-06)
[ResNet] Warning: very low grad mean (3.61e-05)
[ResNet] Warning: very low grad mean (2.98e-05)
[ResNet] Warning: very low grad mean (4.70e-05)
[ResNet] Warning: very low grad mean (5.01e-05)
[ResNet] Warning: very low grad mean (6.56e-05)
[ResNet] Warning: very low grad mean (6.25e-05)
[ResNet] Warning: very low grad mean (9.61e-05)
[ResNet] Warning: very low grad mean (9.92e-05)
[ResNet] Warning: very low grad mean (7.08e-05)
[ResNet] Warning: very low grad mean (5.39e-05)
[ResNet] Warning: very low grad mean (1.93e-05)
[ResNet] Train Epoch 5: Loss=0.00845, Acc=0.99810
[ResNet] Val Epoch 5: Loss=0.14556, Acc=0.94889
[ResNet] Warning: very low grad mean (1.01e-05)
[ResNet] Warning: very low grad mean (7.57e-06)
[ResNet] Warning: very low grad mean (1.29e-05)
[ResNet] Warning: very low grad mean (1.23e-05)
[ResNet] Warning: very low grad mean (2.34e-05)
[ResNet] Warning: very low grad mean (4.73e-05)
[ResNet] Warning: very low grad mean (6.58e-05)
[ResNet] Warning: very low grad mean (5.31e-06)
[ResNet] Warning: very low grad mean (4.57e-05)
[ResNet] Warning: very low grad mean (1.25e-05)
[ResNet] Warning: very low grad mean (5.85e-05)
[ResNet] Warning: very low grad mean (2.57e-05)
[ResNet] Warning: very low grad mean (1.78e-05)
[ResNet] Warning: very low grad mean (2.03e-05)
[ResNet] Warning: very low grad mean (6.58e-05)
[ResNet] Warning: very low grad mean (4.81e-05)
[ResNet] Warning: very low grad mean (5.14e-06)
[ResNet] Warning: very low grad mean (1.58e-05)
[ResNet] Warning: very low grad mean (1.58e-05)
[ResNet] Warning: very low grad mean (5.09e-06)
[ResNet] Warning: very low grad mean (1.60e-05)
[ResNet] Warning: very low grad mean (3.45e-05)
[ResNet] Warning: very low grad mean (6.16e-06)
[ResNet] Warning: very low grad mean (6.20e-05)
[ResNet] Warning: very low grad mean (2.94e-05)
[ResNet] Warning: very low grad mean (4.47e-06)
[ResNet] Warning: very low grad mean (3.21e-05)
[ResNet] Warning: very low grad mean (1.94e-05)
[ResNet] Warning: very low grad mean (8.08e-06)
[ResNet] Warning: very low grad mean (6.36e-06)
[ResNet] Warning: very low grad mean (2.98e-06)
[ResNet] Warning: very low grad mean (3.49e-06)
[ResNet] Warning: very low grad mean (1.31e-05)
[ResNet] Warning: very low grad mean (2.21e-05)
[ResNet] Train Epoch 6: Loss=0.00538, Acc=0.99857
[ResNet] Val Epoch 6: Loss=0.18804, Acc=0.94889
[ResNet] Warning: very low grad mean (4.47e-05)
[ResNet] Warning: very low grad mean (4.34e-05)
[ResNet] Warning: very low grad mean (6.41e-06)
[ResNet] Warning: very low grad mean (5.20e-06)
[ResNet] Warning: very low grad mean (9.37e-06)
[ResNet] Warning: very low grad mean (2.18e-05)
[ResNet] Warning: very low grad mean (3.71e-06)
[ResNet] Warning: very low grad mean (8.59e-06)
[ResNet] Warning: very low grad mean (4.20e-05)
[ResNet] Warning: very low grad mean (1.09e-05)
[ResNet] Warning: very low grad mean (2.03e-05)
[ResNet] Warning: very low grad mean (1.57e-05)
[ResNet] Warning: very low grad mean (9.27e-06)
[ResNet] Warning: very low grad mean (4.50e-06)
[ResNet] Warning: very low grad mean (8.19e-05)
[ResNet] Warning: very low grad mean (6.09e-06)
[ResNet] Warning: very low grad mean (9.99e-06)
[ResNet] Warning: very low grad mean (1.72e-05)
[ResNet] Warning: very low grad mean (7.05e-05)
[ResNet] Warning: very low grad mean (3.53e-05)
[ResNet] Warning: very low grad mean (4.79e-06)
[ResNet] Warning: very low grad mean (5.07e-05)
[ResNet] Warning: very low grad mean (3.52e-05)
[ResNet] Warning: very low grad mean (4.91e-05)
[ResNet] Warning: very low grad mean (6.04e-05)
[ResNet] Warning: very low grad mean (1.11e-05)
[ResNet] Warning: very low grad mean (3.20e-06)
[ResNet] Warning: very low grad mean (2.16e-05)
[ResNet] Warning: very low grad mean (1.18e-05)
[ResNet] Warning: very low grad mean (4.95e-06)
[ResNet] Warning: very low grad mean (2.88e-05)
[ResNet] Warning: very low grad mean (4.42e-05)
[ResNet] Warning: very low grad mean (2.68e-05)
[ResNet] Warning: very low grad mean (8.28e-06)
[ResNet] Train Epoch 7: Loss=0.00582, Acc=0.99810
[ResNet] Val Epoch 7: Loss=0.16155, Acc=0.95556
[ResNet] Warning: very low grad mean (2.45e-05)
[ResNet] Warning: very low grad mean (1.57e-05)
[ResNet] Warning: very low grad mean (5.47e-05)
[ResNet] Warning: very low grad mean (9.67e-06)
[ResNet] Warning: very low grad mean (4.43e-05)
[ResNet] Warning: very low grad mean (5.07e-05)
[ResNet] Warning: very low grad mean (2.72e-05)
[ResNet] Warning: very low grad mean (4.78e-06)
[ResNet] Warning: very low grad mean (3.73e-05)
[ResNet] Warning: very low grad mean (8.64e-06)
[ResNet] Warning: very low grad mean (7.85e-05)
[ResNet] Warning: very low grad mean (1.39e-05)
[ResNet] Warning: very low grad mean (1.14e-05)
[ResNet] Warning: very low grad mean (1.48e-05)
[ResNet] Warning: very low grad mean (9.69e-06)
[ResNet] Warning: very low grad mean (1.22e-05)
[ResNet] Warning: very low grad mean (3.16e-05)
[ResNet] Warning: very low grad mean (1.51e-06)
[ResNet] Warning: very low grad mean (2.20e-06)
[ResNet] Warning: very low grad mean (2.81e-06)
[ResNet] Warning: very low grad mean (2.58e-05)
[ResNet] Warning: very low grad mean (4.12e-06)
[ResNet] Warning: very low grad mean (6.19e-06)
[ResNet] Warning: very low grad mean (4.23e-05)
[ResNet] Warning: very low grad mean (1.68e-05)
[ResNet] Warning: very low grad mean (4.67e-06)
[ResNet] Warning: very low grad mean (2.42e-06)
[ResNet] Warning: very low grad mean (1.50e-05)
[ResNet] Warning: very low grad mean (2.51e-06)
[ResNet] Warning: very low grad mean (6.08e-05)
[ResNet] Warning: very low grad mean (7.78e-06)
[ResNet] Warning: very low grad mean (1.55e-05)
[ResNet] Warning: very low grad mean (1.65e-05)
[ResNet] Warning: very low grad mean (6.13e-06)
[ResNet] Warning: very low grad mean (2.73e-05)
[ResNet] Warning: very low grad mean (1.47e-05)
[ResNet] Warning: very low grad mean (7.49e-06)
[ResNet] Train Epoch 8: Loss=0.00289, Acc=0.99952
[ResNet] Val Epoch 8: Loss=0.16815, Acc=0.95556
[ResNet] Warning: very low grad mean (4.38e-06)
[ResNet] Warning: very low grad mean (1.06e-05)
[ResNet] Warning: very low grad mean (8.33e-06)
[ResNet] Warning: very low grad mean (2.09e-06)
[ResNet] Warning: very low grad mean (8.05e-06)
[ResNet] Warning: very low grad mean (4.96e-05)
[ResNet] Warning: very low grad mean (8.65e-06)
[ResNet] Warning: very low grad mean (1.21e-05)
[ResNet] Warning: very low grad mean (1.36e-05)
[ResNet] Warning: very low grad mean (6.62e-05)
[ResNet] Warning: very low grad mean (5.10e-06)
[ResNet] Warning: very low grad mean (3.21e-06)
[ResNet] Warning: very low grad mean (1.05e-05)
[ResNet] Warning: very low grad mean (1.47e-05)
[ResNet] Warning: very low grad mean (2.60e-05)
[ResNet] Warning: very low grad mean (5.27e-06)
[ResNet] Warning: very low grad mean (4.31e-06)
[ResNet] Warning: very low grad mean (9.43e-06)
[ResNet] Warning: very low grad mean (2.25e-05)
[ResNet] Warning: very low grad mean (7.10e-06)
[ResNet] Warning: very low grad mean (9.68e-06)
[ResNet] Warning: very low grad mean (3.34e-05)
[ResNet] Warning: very low grad mean (9.58e-06)
[ResNet] Warning: very low grad mean (2.76e-05)
[ResNet] Warning: very low grad mean (2.70e-05)
[ResNet] Warning: very low grad mean (2.56e-05)
[ResNet] Warning: very low grad mean (1.14e-05)
[ResNet] Warning: very low grad mean (6.88e-06)
[ResNet] Warning: very low grad mean (1.63e-05)
[ResNet] Warning: very low grad mean (8.57e-05)
[ResNet] Warning: very low grad mean (3.51e-05)
[ResNet] Warning: very low grad mean (3.00e-05)
[ResNet] Warning: very low grad mean (1.43e-05)
[ResNet] Warning: very low grad mean (1.10e-05)
[ResNet] Warning: very low grad mean (1.74e-05)
[ResNet] Warning: very low grad mean (4.37e-05)
[ResNet] Train Epoch 9: Loss=0.00529, Acc=0.99857
[ResNet] Val Epoch 9: Loss=0.17194, Acc=0.94889
[ResNet] Warning: very low grad mean (2.39e-05)
[ResNet] Warning: very low grad mean (7.33e-05)
[ResNet] Warning: very low grad mean (4.57e-05)
[ResNet] Warning: very low grad mean (8.54e-06)
[ResNet] Warning: very low grad mean (3.48e-05)
[ResNet] Warning: very low grad mean (2.82e-06)
[ResNet] Warning: very low grad mean (2.32e-05)
[ResNet] Warning: very low grad mean (2.43e-05)
[ResNet] Warning: very low grad mean (2.09e-05)
[ResNet] Warning: very low grad mean (4.50e-06)
[ResNet] Warning: very low grad mean (5.11e-06)
[ResNet] Warning: very low grad mean (2.97e-05)
[ResNet] Warning: very low grad mean (3.63e-05)
[ResNet] Warning: very low grad mean (7.31e-06)
[ResNet] Warning: very low grad mean (3.28e-05)
[ResNet] Warning: very low grad mean (2.32e-05)
[ResNet] Warning: very low grad mean (4.71e-06)
[ResNet] Warning: very low grad mean (1.17e-05)
[ResNet] Warning: very low grad mean (9.03e-06)
[ResNet] Warning: very low grad mean (5.14e-06)
[ResNet] Warning: very low grad mean (3.49e-06)
[ResNet] Warning: very low grad mean (6.03e-05)
[ResNet] Warning: very low grad mean (7.66e-06)
[ResNet] Warning: very low grad mean (5.00e-06)
[ResNet] Warning: very low grad mean (2.20e-05)
[ResNet] Warning: very low grad mean (1.49e-05)
[ResNet] Warning: very low grad mean (1.41e-05)
[ResNet] Warning: very low grad mean (1.11e-05)
[ResNet] Warning: very low grad mean (4.17e-06)
[ResNet] Warning: very low grad mean (1.85e-05)
[ResNet] Warning: very low grad mean (9.32e-06)
[ResNet] Warning: very low grad mean (7.01e-05)
[ResNet] Warning: very low grad mean (7.91e-06)
[ResNet] Train Epoch 10: Loss=0.00398, Acc=0.99905
[ResNet] Val Epoch 10: Loss=0.17094, Acc=0.95333
[ResNet] Warning: very low grad mean (4.14e-06)
[ResNet] Warning: very low grad mean (2.56e-05)
[ResNet] Warning: very low grad mean (1.18e-05)
[ResNet] Warning: very low grad mean (3.87e-05)
[ResNet] Warning: very low grad mean (9.43e-05)
[ResNet] Warning: very low grad mean (9.47e-05)
[ResNet] Warning: very low grad mean (1.59e-05)
[ResNet] Warning: very low grad mean (1.59e-06)
[ResNet] Warning: very low grad mean (3.63e-05)
[ResNet] Warning: very low grad mean (6.20e-06)
[ResNet] Warning: very low grad mean (1.33e-05)
[ResNet] Warning: very low grad mean (1.73e-05)
[ResNet] Warning: very low grad mean (3.98e-05)
[ResNet] Warning: very low grad mean (1.21e-05)
[ResNet] Warning: very low grad mean (5.71e-06)
[ResNet] Warning: very low grad mean (3.82e-05)
[ResNet] Warning: very low grad mean (1.62e-06)
[ResNet] Warning: very low grad mean (1.13e-05)
[ResNet] Warning: very low grad mean (5.91e-06)
[ResNet] Warning: very low grad mean (2.64e-06)
[ResNet] Warning: very low grad mean (3.92e-06)
[ResNet] Warning: very low grad mean (4.69e-06)
[ResNet] Warning: very low grad mean (1.55e-05)
[ResNet] Warning: very low grad mean (1.66e-05)
[ResNet] Warning: very low grad mean (9.04e-05)
[ResNet] Warning: very low grad mean (1.40e-05)
[ResNet] Warning: very low grad mean (4.40e-06)
[ResNet] Warning: very low grad mean (8.56e-05)
[ResNet] Warning: very low grad mean (2.04e-05)
[ResNet] Warning: very low grad mean (1.29e-05)
[ResNet] Warning: very low grad mean (3.16e-06)
[ResNet] Warning: very low grad mean (3.37e-05)
[ResNet] Warning: very low grad mean (2.17e-05)
[ResNet] Warning: very low grad mean (1.39e-05)
[ResNet] Warning: very low grad mean (2.26e-05)
[ResNet] Warning: very low grad mean (1.20e-05)
[ResNet] Train Epoch 11: Loss=0.00364, Acc=0.99905
[ResNet] Val Epoch 11: Loss=0.17676, Acc=0.96000
[ResNet] Warning: very low grad mean (3.30e-05)
[ResNet] Warning: very low grad mean (9.38e-06)
[ResNet] Warning: very low grad mean (7.07e-05)
[ResNet] Warning: very low grad mean (2.98e-06)
[ResNet] Warning: very low grad mean (4.98e-06)
[ResNet] Warning: very low grad mean (1.37e-05)
[ResNet] Warning: very low grad mean (6.44e-06)
[ResNet] Warning: very low grad mean (5.33e-06)
[ResNet] Warning: very low grad mean (1.17e-06)
[ResNet] Warning: very low grad mean (6.17e-05)
[ResNet] Warning: very low grad mean (3.71e-06)
[ResNet] Warning: very low grad mean (2.03e-06)
[ResNet] Warning: very low grad mean (1.56e-05)
[ResNet] Warning: very low grad mean (1.16e-05)
[ResNet] Warning: very low grad mean (4.67e-06)
[ResNet] Warning: very low grad mean (2.33e-06)
[ResNet] Warning: very low grad mean (1.13e-05)
[ResNet] Warning: very low grad mean (4.67e-05)
[ResNet] Warning: very low grad mean (4.68e-06)
[ResNet] Warning: very low grad mean (8.28e-06)
[ResNet] Warning: very low grad mean (1.84e-06)
[ResNet] Warning: very low grad mean (2.32e-06)
[ResNet] Warning: very low grad mean (2.88e-06)
[ResNet] Warning: very low grad mean (1.58e-05)
[ResNet] Warning: very low grad mean (5.69e-06)
[ResNet] Warning: very low grad mean (1.51e-05)
[ResNet] Warning: very low grad mean (6.11e-06)
[ResNet] Warning: very low grad mean (3.94e-06)
[ResNet] Warning: very low grad mean (2.72e-05)
[ResNet] Warning: very low grad mean (7.46e-06)
[ResNet] Warning: very low grad mean (3.15e-06)
[ResNet] Warning: very low grad mean (1.27e-06)
[ResNet] Warning: very low grad mean (3.38e-05)
[ResNet] Warning: very low grad mean (2.52e-06)
[ResNet] Warning: very low grad mean (2.61e-05)
[ResNet] Warning: very low grad mean (4.90e-06)
[ResNet] Warning: very low grad mean (3.14e-06)
[ResNet] Warning: very low grad mean (1.09e-06)
[ResNet] Train Epoch 12: Loss=0.00138, Acc=1.00000
[ResNet] Val Epoch 12: Loss=0.17780, Acc=0.94889
[ResNet] Early stopping on epoch 12
Accuracy on Test: 0.96889
=== Training finished for ResNet ===

